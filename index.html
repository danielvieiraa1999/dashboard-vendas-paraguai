<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard - Produtos</title>
<style>
body{font-family:Arial;background:#f4f6f8;margin:0}
.hidden{display:none}
.center{display:flex;justify-content:center;align-items:center;height:100vh}
.box{background:#fff;padding:20px;border-radius:10px;width:380px}
input,button{width:100%;padding:8px;margin-top:8px}
button{background:#0038a8;color:#fff;border:none;border-radius:6px}
table{width:100%;margin-top:15px;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
</style>
</head>

<body>

<div id="loginScreen" class="center">
  <div class="box">
    <h2>Login</h2>
    <input id="email" placeholder="Email">
    <input id="senha" type="password" placeholder="Senha">
    <button id="btnLogin">Entrar</button>
    <p id="erro" style="color:red"></p>
  </div>
</div>

<div id="appScreen" class="hidden center">
  <div class="box">
    <h2>Produtos ðŸ“¦</h2>

    <input id="nome" placeholder="Nome do produto">
    <input id="custo" type="number" placeholder="Custo">
    <input id="preco" type="number" placeholder="PreÃ§o de venda">
    <input id="estoque" type="number" placeholder="Estoque">
    <button id="addProduto">Adicionar produto</button>

    <table>
      <thead>
        <tr>
          <th>Produto</th>
          <th>PreÃ§o</th>
          <th>Estoque</th>
        </tr>
      </thead>
      <tbody id="listaProdutos"></tbody>
    </table>

    <button id="btnLogout" style="margin-top:15px">Sair</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCe-e8rB5b3JRxzsMnAid3l2MOLDI4Ym9A",
  authDomain: "dashboard-vendas-paraguai.firebaseapp.com",
  projectId: "dashboard-vendas-paraguai"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const produtosRef = collection(db, "produtos");

btnLogin.onclick = () => {
  signInWithEmailAndPassword(auth, email.value, senha.value)
    .catch(e => erro.innerText = e.message);
};

btnLogout.onclick = () => signOut(auth);

onAuthStateChanged(auth, user => {
  if(user){
    loginScreen.classList.add("hidden");
    appScreen.classList.remove("hidden");
  } else {
    appScreen.classList.add("hidden");
    loginScreen.classList.remove("hidden");
  }
});

addProduto.onclick = async () => {
  await addDoc(produtosRef, {
    nome: nome.value,
    custo: Number(custo.value),
    preco: Number(preco.value),
    estoque: Number(estoque.value)
  });
  nome.value = custo.value = preco.value = estoque.value = "";
};

onSnapshot(produtosRef, snapshot => {
  listaProdutos.innerHTML = "";
  snapshot.forEach(doc => {
    const p = doc.data();
    listaProdutos.innerHTML += `
      <tr>
        <td>${p.nome}</td>
        <td>${p.preco}</td>
        <td>${p.estoque}</td>
      </tr>
    `;
  });
});
</script>

</body>
</html>
