<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard - Login</title>
<style>
body{font-family:Arial;background:#f4f6f8;margin:0}
.center{display:flex;align-items:center;justify-content:center;height:100vh}
.box{background:#fff;padding:25px;border-radius:10px;width:320px}
input,button{width:100%;padding:10px;margin-top:10px}
button{background:#0038a8;color:#fff;border:none;border-radius:6px}
.hidden{display:none}
</style>
</head>

<body>

<div id="login" class="center">
  <div class="box">
    <h2>Login</h2>
    <input id="email" placeholder="Email">
    <input id="senha" type="password" placeholder="Senha">
    <button onclick="login()">Entrar</button>
    <p id="erro" style="color:red"></p>
  </div>
</div>

<div id="app" class="hidden center">
  <div class="box">
    <h2>Dashboard conectado ☁️</h2>
    <p>Firestore funcionando</p>
    <button onclick="criarTeste()">Criar dado teste</button>
    <button onclick="logout()">Sair</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCe-e8rB5b3JRxzsMnAid3l2MOLDI4Ym9A",
  authDomain: "dashboard-vendas-paraguai.firebaseapp.com",
  projectId: "dashboard-vendas-paraguai",
  storageBucket: "dashboard-vendas-paraguai.firebasestorage.app",
  messagingSenderId: "435240613744",
  appId: "1:435240613744:web:7f28f134980959e654c1b5"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const empresaRef = doc(db, "empresa", "padrao");

window.login = () => {
  signInWithEmailAndPassword(auth, email.value, senha.value)
    .catch(() => erro.innerText = "Login inválido");
};

window.logout = () => signOut(auth);

window.criarTeste = async () => {
  await setDoc(empresaRef, {
    criadoEm: new Date().toISOString(),
    status: "Firestore OK"
  });
  alert("Documento criado no Firestore!");
};

onAuthStateChanged(auth, user => {
  if(user){
    login.classList.add("hidden");
    app.classList.remove("hidden");
  } else {
    app.classList.add("hidden");
    login.classList.remove("hidden");
  }
});
</script>

</body>
</html>
